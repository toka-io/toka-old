"use strict";function SettingsApp(t){this.options=t,this.openTab="general",this.settings={general:{soundNotification:{name:"Sound Notifications",value:{0:{name:"Off",title:"Never sound on a new message in an open chat"},1:{name:"Always",title:"Always sound on a new message in an open chat"},2:{name:"Hidden Tabs",title:"Always sound on a new message in an open chat"}}}},email:{emailNotification:{name:"Email Notifications",value:{0:{name:"Off",title:"Never send me emails"},1:{name:"All",title:"Send me important information and updates"},2:{name:"Important Only",title:"Only send me important information for Toka"},3:{name:"Updates Only",title:"Only send me chatroom updates for rooms I follow"}}}},billing:{}},this.ini=function(){var t=this;t.createSettings(this.settings);for(var e in t.options)t.settingsTag(e,t.options[e],!1);t.resize(),$(window).on("resize",function(){t.resize()})},this.resize=function(){$("#settings-body-general").css("min-height",$("#site").height()-$("#site-menu").height()-50),$("#settings-body-email").css("min-height",$("#site").height()-$("#site-menu").height()-50),$("#settings-body-billing").css("min-height",$("#site").height()-$("#site-menu").height()-50)},this.update=function(t,e){var n=this;"undefined"==typeof e&&(e={}),$.ajax({url:"/settings/update",type:"put",data:JSON.stringify(t),dataType:"json",contentType:"application/json; charset=utf-8",timeout:8e3,beforeSend:e.hasOwnProperty("beforeSend")?e.beforeSend:function(){},complete:e.hasOwnProperty("complete")?e.complete:function(){},success:function(e){n.responseHandler(t,e)},error:function(e,s,i){n.errorHandler(s,i,t)}})},this.responseHandler=function(t,e){e.result},this.errorHandler=function(t,e,n){},this.settingsTab=function(t){"none"==$("#"+t+"-settings").css("display")?($("#"+t+"-settings").css("display","flex"),$("#"+t+"-tag").addClass("settings-orange")):($("#"+t+"-settings").css("display","none"),$("#"+t+"-tag").removeClass("settings-orange"))},this.settingsTag=function(t,e,n){var s=this;$("#"+t+"-tag").text(s.settingType(t,e));var i={};i[t]=e,n&&s.update(i)},this.settingsBar=function(t){var e=this;$("#"+e.openTab).removeClass("settings-orange"),t.classList.add("settings-orange"),$("#settings-body-"+e.openTab).removeClass("settings-active"),$("#settings-body-"+t.id).addClass("settings-active"),e.openTab=t.id},this.settingType=function(t,e){var n=this;for(var s in n.settings)try{return n.settings[s][t].value[e].name}catch(i){}},this.createSettings=function(t){for(var e in t)for(var n in t[e]){var s=t[e][n].name,i=$("<li>",{id:n}).append($("<h3>"+s+"<h3>")).append($("<a></a>",{text:"Off","class":"settings-tag",id:n+"-tag",onclick:"settings.settingsTab('"+n+"');"})),a=$("<div></div>",{"class":"settings-tab",id:n+"-settings"});for(var o in t[e][n].value){var r=t[e][n].value[o].name,g=t[e][n].value[o].title;a.append($("<a></a>",{text:r,onclick:"settings.settingsTag('"+n+"', "+o+", true); settings.settingsTab('"+n+"');",title:g}))}i.append(a),$("#"+e+"-settings").append(i)}}}