"use strict";var AtlasClient=function(){this.events={},this.endpoint="dev.toka.io:1337",this.nodeList=["dev.toka.io:1337"],this.protocol="ws",this.socket};AtlasClient.prototype.connect=function(t,i){var e=this;this.protocol=t?"wss":"ws",this.endpoint=i,this.socket=new WebSocket(this.protocol+"://"+this.endpoint),this.socket.onmessage=function(t){var t=JSON.parse(t.data);e.events.hasOwnProperty(t.id)&&e.events[t.id](t)}},AtlasClient.prototype.retry=function(){if(1!==this.nodeList.length)for(i=0;i<this.nodeList.length;i++)this.nodeList[i]!==this.endpoint&&(this.socket=new WebSocket(this.protocol+"://"+this.endpoint))},AtlasClient.prototype.on=function(t,i){"connect"===t?this.socket.onopen=i:this.events[t]=i},AtlasClient.prototype.send=function(t){this.socket.send(t)};var Message=function(t,i,e,s){this.chatroomid=t,this.username=i,this.text=e,this.timestamp=s?s:moment().utc().format("MMM D, YYYY h:mm a")};Message.prototype.deserialize=function(t){return this.chatroomId=t.chatroomId,this.username=t.username,this.text=t.text,t.timestamp?this.timestamp=t.timestamp:this.timestamp=moment().utc().format("MMM D, YYYY h:mm a"),this},Message.prototype.serialize=function(){return JSON.stringify(this)},Message.isValid=function(t){return"string"==typeof t.chatroomId&&"string"==typeof t.text&&"string"==typeof t.username};var Event=function(t,i,e){this.ns=t,this.id=i,this.data=e,this.uid=function(){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_",e=0;30>e;e++)t+=i.charAt(Math.floor(Math.random()*i.length));return t}()};Event.prototype.deserialize=function(t){return this.ns=t.ns,this.id=t.id,this.data=t.data,this.uid=t.uid,this},Event.prototype.serialize=function(){return JSON.stringify(this)},Event.isValid=function(t){return"string"!=typeof t.ns||"string"!=typeof t.id||"string"!=typeof t.uid?!1:30==t.uid.length};