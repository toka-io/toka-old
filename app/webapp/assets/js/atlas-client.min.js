"use strict";var AtlasClient=function(){this.events={},this.endpoint="dev.toka.io:1337",this.nodeList=["dev.toka.io:1337"],this.protocol="ws",this.socket};AtlasClient.prototype.connect=function(t,e){var i=this;this.protocol=t?"wss":"ws",this.endpoint=e,this.socket=new WebSocket(this.protocol+"://"+this.endpoint),this.socket.onmessage=function(t){var t=JSON.parse(t.data);i.events.hasOwnProperty(t.id)&&i.events[t.id](t.data)}},AtlasClient.prototype.retry=function(){if(1!==this.nodeList.length)for(i=0;i<this.nodeList.length;i++)this.nodeList[i]!==this.endpoint&&(this.socket=new WebSocket(this.protocol+"://"+this.endpoint))},AtlasClient.prototype.on=function(t,e){"connect"===t?this.socket.onopen=e:this.events[t]=e},AtlasClient.prototype.send=function(t){this.socket.send(t)};var Message=function(t,e,i,s){this.chatroomId=t,this.username=e,this.text=i,this.timestamp=s?s():s};Message.prototype.deserialize=function(t){return this.validate(t)?(this.chatroomId=t.chatroomId.trim(),this.username=t.username.trim(),this.text=t.text,t.timestamp?this.timestamp=t.timestamp.trim():this.timestamp=timestamp(),void 0):!1},Message.prototype.serialize=function(){return JSON.stringify(this)},Message.prototype.validate=function(t){return"string"!=typeof t.chatroomId||"string"!=typeof t.text||"string"!=typeof t.username?!1:!0};